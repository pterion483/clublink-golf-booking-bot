# Claude Code Golf Booking System - Direct MCP Execution
# This crontab launches Claude Code directly to execute bookings
# Environment
SHELL=/bin/bash
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/home/dmin1/.local/bin

# Main Booking Job - 6:30 AM
# Generates prompt then launches Claude Code to execute it
30 6 * * * /home/dmin1/Golf\ Tee\ Times\ Bot/claude_executor.sh book >> /home/dmin1/Golf\ Tee\ Times\ Bot/logs/cron_claude_$(date +\%Y\%m\%d).log 2>&1

# Morning Gap Finder - DAYTIME every 15 minutes (6 AM - 9 PM)
# Checks tomorrow through day 5 for gaps and books them
*/15 6-21 * * * /home/dmin1/Golf\ Tee\ Times\ Bot/claude_executor.sh gap >> /home/dmin1/Golf\ Tee\ Times\ Bot/logs/cron_claude_gap_$(date +\%Y\%m\%d).log 2>&1

# Morning Gap Finder - OVERNIGHT every hour (10 PM - 5 AM)
# Checks day 2 through day 5 (skips tomorrow for cancellation time)
0 22,23 * * * /home/dmin1/Golf\ Tee\ Times\ Bot/claude_executor.sh gap-night >> /home/dmin1/Golf\ Tee\ Times\ Bot/logs/cron_claude_gap_night_$(date +\%Y\%m\%d).log 2>&1
0 0-5 * * * /home/dmin1/Golf\ Tee\ Times\ Bot/claude_executor.sh gap-night >> /home/dmin1/Golf\ Tee\ Times\ Bot/logs/cron_claude_gap_night_$(date +\%Y\%m\%d).log 2>&1

# Test execution every hour to verify Claude Code is working
0 * * * * /home/dmin1/Golf\ Tee\ Times\ Bot/claude_executor.sh test >> /home/dmin1/Golf\ Tee\ Times\ Bot/logs/cron_claude_test_$(date +\%Y\%m\%d).log 2>&1

# Maintenance - Clean up old screenshots and logs
0 3 * * * find "/home/dmin1/Golf Tee Times Bot/screenshots" -type f -name "*.png" -mtime +7 -delete 2>/dev/null
0 2 * * 0 cd "/home/dmin1/Golf Tee Times Bot/logs" && gzip -9 *.log 2>/dev/null; find . -name "*.gz" -mtime +30 -delete
